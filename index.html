<!DOCTYPE html>
<html lang="en">
 <head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Vulnerability Scanner</title>
  <link rel="canonical" href="https://oshekher.heliohost.us" />
  <meta name="robots" content="index, follow" />
  <meta name="author" content="OshekharO" />
  <meta name="copyright" content="Copyright Â© 2024 OshekharO" />
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet" />
  <style>
   body {
    font-size: 14px;
    line-height: 1.6;
    color: #616370;
    background: #26272c;
    height: 100%;
    position: relative;
    margin: 1.5rem;
   }
  </style>
 </head>
 <body class="bg-dark text-light">
  <div class="container py-2">
   <h1 class="text-center mb-5">Vulnerability Scanner</h1>
   <form id="form">
    <div class="form-group">
     <label for="link-input" class="fs-6 font-monospace badge bg-danger mb-2">Link:</label>
     <input type="text" class="form-control" id="link-input" placeholder="Enter link" />
    </div>
    <div class="form-group">
     <label for="payload-input" class="fs-6 font-monospace badge bg-danger mb-2 mt-2">Payloads:</label>
     <textarea class="form-control" id="payload-input" rows="10" placeholder="Enter payloads"></textarea>
    </div>
    <div class="d-grid gap-2 d-md-flex justify-content-md-center mt-3">
     <button type="button" onclick="scan()" class="btn btn-outline-success">SCAN</button>
    </div>
    <div class="alert alert-success mt-3" id="vulnerable-results">
     <h3 class="font-monospace">Vulnerable - <span id="vulnerable-count" class="badge bg-success">0</span></h3>
     <div id="vulnerable-list"></div>
    </div>
    <div class="alert alert-danger mt-3" id="not-vulnerable-results">
     <h3 class="font-monospace">Not Vulnerable - <span id="not-vulnerable-count" class="badge bg-danger">0</span></h3>
     <div id="not-vulnerable-list"></div>
    </div>
    <div class="alert alert-warning mt-3" id="redirect-results">
     <h3 class="font-monospace">Redirect - <span id="redirect-count" class="badge bg-warning">0</span></h3>
     <div id="redirect-list"></div>
    </div>
   </form>
  </div>
  <script src="https://code.jquery.com/jquery-3.7.1.min.js" integrity="sha256-/JqT3SQfawRcv/BIHPThkBvs0OEvtFFmqPF/lYI/Cxo=" crossorigin="anonymous"></script>

  <script>
   function scan() {
    const link = document.getElementById("link-input").value;
    const payloads = document.getElementById("payload-input").value.split("\n");
    const corsProxyUrl = "https://cors-bypasser-gilt.vercel.app/fetchdata";
    const vulnerableElement = document.getElementById("vulnerable-list");
    const notVulnerableElement = document.getElementById("not-vulnerable-list");
    const redirectElement = document.getElementById("redirect-list");
    vulnerableElement.textContent = "";
    notVulnerableElement.textContent = "";
    redirectElement.textContent = "";

    payloads.forEach((payload) => {
     const completeUrl = link + payload.trim();
     const fetchUrl = `${corsProxyUrl}?url=${encodeURIComponent(completeUrl)}`;

     $.ajax({
      type: "HEAD",
      url: fetchUrl,
      async: false,
      success: function (data, textStatus, jqXHR) {
       const statusCode = jqXHR.getResponseHeader("X-Status-Code") || jqXHR.status;
       if (statusCode >= 200 && statusCode < 300) {
        vulnerableElement.innerHTML += `${completeUrl}<br>`;
        document.getElementById("vulnerable-count").textContent = Number(document.getElementById("vulnerable-count").textContent) + 1;
       } else if (statusCode >= 300 && statusCode < 400) {
        redirectElement.innerHTML += `${completeUrl}<br>`;
        document.getElementById("redirect-count").textContent = Number(document.getElementById("redirect-count").textContent) + 1;
       } else {
        notVulnerableElement.innerHTML += `${completeUrl}<br>`;
        document.getElementById("not-vulnerable-count").textContent = Number(document.getElementById("not-vulnerable-count").textContent) + 1;
       }
      },
      error: function (jqXHR, textStatus, errorThrown) {
       const statusCode = jqXHR.status;
       if (statusCode >= 200 && statusCode < 300) {
        vulnerableElement.innerHTML += `${completeUrl}<br>`;
        document.getElementById("vulnerable-count").textContent = Number(document.getElementById("vulnerable-count").textContent) + 1;
       } else if (statusCode >= 300 && statusCode < 400) {
        redirectElement.innerHTML += `${completeUrl}<br>`;
        document.getElementById("redirect-count").textContent = Number(document.getElementById("redirect-count").textContent) + 1;
       } else {
        notVulnerableElement.innerHTML += `${completeUrl}<br>`;
        document.getElementById("not-vulnerable-count").textContent = Number(document.getElementById("not-vulnerable-count").textContent) + 1;
       }
      },
     });
    });
   }
  </script>
 </body>
</html>
